const hamburger=document.querySelector(".hamburger"),menu=document.querySelector(".opened__menu"),close=document.querySelector(".close-icon"),body=document.querySelector("body"),menuList=document.querySelector(".menu__list--opened"),openItem=(hamburger.addEventListener("click",function(e){e.preventDefault(),menu.classList.add("opened__menu--active"),body.classList.add("noscroll")}),close.addEventListener("click",function(e){menu.classList.remove("opened__menu--active"),body.classList.remove("noscroll")}),menuList.addEventListener("click",function(e){e.preventDefault(),menu.classList.remove("opened__menu--active"),body.classList.remove("noscroll")}),e=>{const t=e.closest(".team__item"),a=t.find(".team__content"),n=a.find(".team__content-block");e=n.height();t.addClass("active"),a.height(e)}),closeEveryItem=e=>{const t=e.find(".team__content"),a=e.find(".team__item");a.removeClass("active"),t.height(0)};$(".team__title").click(e=>{const t=$(e.currentTarget);e=t.closest(".team");const a=t.closest(".team__item");a.hasClass("active")?closeEveryItem(e):(closeEveryItem(e),openItem(t))});let myMap;const init=()=>{myMap=new ymaps.Map("map",{center:[57.70887,11.97456],zoom:11,controls:[],garg:!1});let t=[[57.78092897893155,11.989493586343999],[57.72747991234878,11.95783423148954],[57.68380486944938,11.936570485691767],[57.663843251732786,12.031548550255145]],a=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"/src/images/marker.svg",iconImageSize:[46,57],iconImageOffset:[-35,-52]});for(let e=0;e<t.length;e++)a.add(new ymaps.Placemark(t[e]));myMap.geoObjects.add(a),myMap.behaviors.disable("scrollZoom")},mesureWidth=(ymaps.ready(init),e=>{let t=0;var a=$(window).width();const n=e.closest(".products-menu"),s=n.find(".products-menu__title");var o=s.width()*s.length;const r=e.find(".products-menu__container");var e=parseInt(r.css("padding-left")),i=parseInt(r.css("padding-right")),l=window.matchMedia("(max-width: 768px)").matches;return{container:t=l?a-o:500,textContainer:t-i-e}}),closeEveryItemInContainer=e=>{const t=e.find(".products-menu__item"),a=e.find(".products-menu__content");t.removeClass("active"),a.width(0)},openingItem=e=>{const t=e.find(".products-menu__content");var a=mesureWidth(e);const n=e.find(".products-menu__container");e.addClass("active"),t.width(a.container),n.width(a.textContainer)},validateFields=($(".products-menu__title").on("click",e=>{e.preventDefault();const t=$(e.currentTarget),a=t.closest(".products-menu__item");var e=a.hasClass("active"),n=t.closest(".products-menu");e?closeEveryItemInContainer(n):(closeEveryItemInContainer(n),openingItem(a))}),$(".products-menu__close").on("click",e=>{e.preventDefault(),closeEveryItemInContainer($(".products-menu"))}),(e,t)=>{return t.forEach(e=>{e.removeClass("input-error"),""==e.val().trim()&&e.addClass("input-error")}),0==e.find(".input-error").length}),sections=($(".form").submit(e=>{e.preventDefault();const t=$(e.currentTarget),a=t.find("[name='name']"),n=t.find("[name='phone']"),s=t.find("[name='comment']"),o=t.find("[name='to']"),r=$("#modal"),i=r.find("modal__content");e=validateFields(t,[a,n,s,o]);if(r.removeClass("error-modal"),e){const l=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:a.val(),phone:n.val(),comment:s.val(),to:o.val()}});l.done(e=>{i.text(e.message)}),l.fail(e=>{e=e.responseJSON.message;i.text(e),r.addClass("error-modal")}),l.always(()=>{$.fancybox.open({src:"#modal",type:"inline"})})}}),$(".button-close").click(e=>{e.preventDefault();$(e.currentTarget);$.fancybox.close(),$("#form")[0].reset()}),$(".section")),display=$(".maincontent"),sideMenu=$(".fixed-menu"),menuItems=sideMenu.find(".fixed-menu__item");let inScroll=!1;sections.first().addClass("active");const countSectionPosition=e=>-100*e,changeMenuThemeForSection=e=>{const t=sections.eq(e);"black"==t.attr("data-sidemenu-theme")?sideMenu.addClass("activeClass"):sideMenu.removeClass("ctiveClass")},resetActiveClassForItem=(e,t,a)=>{e.eq(t).addClass(a).siblings().removeClass(a)},performTransition=e=>{if(0==inScroll){inScroll=!0;const t=countSectionPosition(e);changeMenuThemeForSection(e),display.css({transform:`translateY(${t}%)`}),resetActiveClassForItem(sections,e,"active"),sections.eq(e).addClass("active").siblings().removeClass("active"),setTimeout(()=>{inScroll=!1,resetActiveClassForItem(menuItems,e,".fixed-menu__item--active"),sideMenu.find(".fixed-menu__item").eq(e).addClass("fixed-menu__item--active").siblings().removeClass("fixed-menu__item--active")},1300)}},scrollViewport=e=>{const t=sections.filter(".active"),a=t.next(),n=t.prev();"next"==e&&a.length&&performTransition(a.index()),"prev"==e&&n.length&&performTransition(n.index())},playerContainer=($(window).on("wheel",e=>{e=e.originalEvent.deltaY;0<e&&scrollViewport("next"),e<0&&scrollViewport("prev")}),$(window).on("keydown",e=>{var t=e.target.tagName.toLowerCase();if("input"!==t&&"textarea"!==t)switch(e.keyCode){case 38:scrollViewport("prev");break;case 40:scrollViewport("next")}}),$("[data-scroll-to]").click(e=>{e.preventDefault();const t=$(e.currentTarget);e=t.attr("data-scroll-to");const a=$(`[data-section-id=${e}]`);performTransition(a.index())}),$(".player")),playerStart=$(".player__start"),volumeBtn=$(".volume__pic");let eventsInit=()=>{$(".player__start").click(e=>{e.preventDefault();$(e.currentTarget);playerStart.hasClass("player--paused")?player.pauseVideo():player.playVideo(),onPlayerReady()}),$(".player__playback").click(e=>{const t=$(e.currentTarget);var e=e.originalEvent.layerX/t.width()*100,a=player.getDuration()/100*e;$(".player__playback-button").css({left:e+"%"}),player.seekTo(a)}),$(".player__splash__play").click(e=>{player.playVideo()}),$(".volume__pic").click(e=>{e.preventDefault(),volumeBtn.hasClass("volume__pic--nosound")?(player.unMute(),volumeBtn.removeClass("volume__pic--nosound")):(player.mute(),volumeBtn.addClass("volume__pic--nosound"))}),$(".volume__playback").click(e=>{const t=$(e.currentTarget);e=e.originalEvent.layerX/t.width()*100;player.getVolume();$(".volume__playback-button").css({left:e+"%"}),player.setVolume(e)})};const onPlayerReady=()=>{let e;const t=player.getDuration();void 0!==e&&clearInterval(e),e=setInterval(()=>{var e=player.getCurrentTime()/t*100;$(".player__playback-button").css({left:e+"%"})},1e3)},onPlayerStateChange=e=>{switch(e.data){case 1:playerContainer.addClass("active"),playerStart.addClass("player--paused");break;case 2:playerContainer.removeClass("active"),playerStart.removeClass("player--paused")}};function onYouTubeIframeAPIReady(){player=new YT.Player("yt-player",{height:"405",width:"660",videoId:"LXb3EKWsInQ",events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange},playerVars:{controls:0,disablekb:0,showinfo:0,rel:0,autoplay:0,modesbranding:0}})}eventsInit();const slider=$(".slider").bxSlider({pager:!1,controls:!1}),findBlockByAlias=($(".arrow-left").click(e=>{slider.goToPrevSlide()}),$(".arrow-right").click(e=>{slider.goToNextSlide()}),a=>$(".reviews-item").filter((e,t)=>$(t).attr("data-linked-with")==a));$(".reviews-switcher__link").click(e=>{e.preventDefault();const t=$(e.currentTarget);e=t.attr("data-open");const a=findBlockByAlias(e),n=t.closest(".reviews-switcher__item");a.addClass("active").siblings().removeClass("active"),n.addClass("active").siblings().removeClass("active")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjEuanMiLCJhY2NvLmpzIiwibWFwLmpzIiwibWVudS1hY2NvLmpzIiwibW9kYWwuanMiLCJvcHMuanMiLCJwbGF5ZXIuanMiLCJzbGlkZXIuanMiLCJ0YWJzLmpzIl0sIm5hbWVzIjpbImhhbWJ1cmdlciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm1lbnUiLCJjbG9zZSIsImJvZHkiLCJtZW51TGlzdCIsIm9wZW5JdGVtIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJpdGVtIiwiY29udGFpbmVyIiwiY2xvc2VzdCIsImNvbnRlbnRCbG9jayIsImZpbmQiLCJ0ZXh0QmxvY2siLCJyZXFIZWlnaHQiLCJoZWlnaHQiLCJhZGRDbGFzcyIsImNsb3NlRXZlcnlJdGVtIiwiaXRlbXMiLCJpdGVtQ29udGFpbmVyIiwicmVtb3ZlQ2xhc3MiLCIkIiwiY2xpY2siLCJlIiwiJHRoaXMiLCJjdXJyZW50VGFyZ2V0IiwiZWxlbUNvbnRhaW5lciIsImhhc0NsYXNzIiwibGV0IiwibXlNYXAiLCJpbml0IiwieW1hcHMiLCJNYXAiLCJjZW50ZXIiLCJ6b29tIiwiY29udHJvbHMiLCJnYXJnIiwiY29vcmRzIiwibXlDb2xsZWN0aW9uIiwiR2VvT2JqZWN0Q29sbGVjdGlvbiIsImRyYWdnYWJsZSIsImljb25MYXlvdXQiLCJpY29uSW1hZ2VIcmVmIiwiaWNvbkltYWdlU2l6ZSIsImljb25JbWFnZU9mZnNldCIsImkiLCJsZW5ndGgiLCJQbGFjZW1hcmsiLCJnZW9PYmplY3RzIiwiYmVoYXZpb3JzIiwiZGlzYWJsZSIsIm1lc3VyZVdpZHRoIiwicmVhZHkiLCJyZXFJdGVtV2lkdGgiLCJzY3JlZW5XaWR0aCIsIndpbmRvdyIsIndpZHRoIiwidGl0bGVzQmxvY2tzIiwidGl0bGVzV2lkdGgiLCJ0ZXh0Q29udGFpbmVyIiwicGFkZGluZ0xlZnQiLCJwYXJzZUludCIsImNzcyIsInBhZGRpbmdSaWdodCIsImlzTW9iaWxlIiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyIiwiY29udGVudCIsIm9wZW5pbmdJdGVtIiwiaGlkZGVuQ29udGVudCIsInJlcVdpZHRoIiwidmFsaWRhdGVGaWVsZHMiLCJvbiIsIml0ZW1PcGVuZWQiLCJmb3JtIiwiZmllbGRzQXJyYXkiLCJmb3JFYWNoIiwiZmllbGQiLCJ2YWwiLCJ0cmltIiwic2VjdGlvbnMiLCJzdWJtaXQiLCJuYW1lIiwicGhvbmUiLCJjb21tZW50IiwidG8iLCJtb2RhbCIsImlzVmFsaWQiLCJyZXF1ZXN0IiwiYWpheCIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJkb25lIiwidGV4dCIsIm1lc3NhZ2UiLCJmYWlsIiwicmVzcG9uc2VKU09OIiwiYWx3YXlzIiwiZmFuY3lib3giLCJvcGVuIiwic3JjIiwidHlwZSIsInJlc2V0IiwiZGlzcGxheSIsInNpZGVNZW51IiwibWVudUl0ZW1zIiwiaW5TY3JvbGwiLCJmaXJzdCIsImNvdW50U2VjdGlvblBvc2l0aW9uIiwic2VjdGlvbkVxIiwiY2hhbmdlTWVudVRoZW1lRm9yU2VjdGlvbiIsImN1cnJlbnRTZWN0aW9uIiwiZXEiLCJhdHRyIiwicmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0iLCJpdGVtRXEiLCJhY3RpdmVDbGFzcyIsInNpYmxpbmdzIiwicGVyZm9ybVRyYW5zaXRpb24iLCJwb3NpdGlvbiIsInRyYW5zZm9ybSIsInNldFRpbWVvdXQiLCJzY3JvbGxWaWV3cG9ydCIsImFjdGl2ZVNlY3Rpb24iLCJmaWx0ZXIiLCJuZXh0U2VjdGlvbiIsIm5leHQiLCJwcmV2U2VjdGlvbiIsInByZXYiLCJkaXJlY3Rpb24iLCJpbmRleCIsInBsYXllckNvbnRhaW5lciIsImRlbHRhWSIsIm9yaWdpbmFsRXZlbnQiLCJ0YWdOYW1lIiwidGFyZ2V0IiwidG9Mb3dlckNhc2UiLCJrZXlDb2RlIiwicmVxU2VjdGlvbiIsInBsYXllclN0YXJ0Iiwidm9sdW1lQnRuIiwiZXZlbnRzSW5pdCIsInBsYXllciIsInBhdXNlVmlkZW8iLCJwbGF5VmlkZW8iLCJvblBsYXllclJlYWR5IiwiYmFyIiwibmV3QnV0dG9uUG9zaXRpb25QZXJjZW50IiwibGF5ZXJYIiwibmV3UGxheWJhY2tQb3NpdGlvblNlYyIsImdldER1cmF0aW9uIiwibGVmdCIsInNlZWtUbyIsInVuTXV0ZSIsIm11dGUiLCJiYXJWb2x1bWUiLCJuZXdWb2x1bWVCdXR0b25Qb3NpdGlvblBlcmNlbnQiLCJnZXRWb2x1bWUiLCJzZXRWb2x1bWUiLCJpbnRlcnZhbCIsImR1cmF0aW9uU2VjIiwiY2xlYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiY29tcGxldGVkUGVyY2VudCIsImdldEN1cnJlbnRUaW1lIiwib25QbGF5ZXJTdGF0ZUNoYW5nZSIsIm9uWW91VHViZUlmcmFtZUFQSVJlYWR5IiwiWVQiLCJQbGF5ZXIiLCJ2aWRlb0lkIiwiZXZlbnRzIiwib25SZWFkeSIsIm9uU3RhdGVDaGFuZ2UiLCJwbGF5ZXJWYXJzIiwiZGlzYWJsZWtiIiwic2hvd2luZm8iLCJyZWwiLCJhdXRvcGxheSIsIm1vZGVzYnJhbmRpbmciLCJzbGlkZXIiLCJieFNsaWRlciIsInBhZ2VyIiwiZmluZEJsb2NrQnlBbGlhcyIsImdvVG9QcmV2U2xpZGUiLCJnb1RvTmV4dFNsaWRlIiwibmR4IiwiYWxpYXMiLCJpdGVtVG9TaG93IiwiY3VySXRlbSJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBQUEsVUFBQUMsU0FBQUMsY0FBQSxjQUNBQyxLQUFBRixTQUFBQyxjQUFBLGlCQUNBRSxNQUFBSCxTQUFBQyxjQUFBLGVBQ0FHLEtBQUFKLFNBQUFDLGNBQUEsUUFDQUksU0FBQUwsU0FBQUMsY0FBQSx1QkNKQUssVURNQVAsVUFBQVEsaUJBQUEsUUFBQSxTQUFBQyxHQUNBQSxFQUFBQyxpQkFDQVAsS0FBQVEsVUFBQUMsSUFBQSx3QkFDQVAsS0FBQU0sVUFBQUMsSUFBQSxjQUdBUixNQUFBSSxpQkFBQSxRQUFBLFNBQUFDLEdBQ0FOLEtBQUFRLFVB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QXJLLEVBQUEsaUJBQUF5RyxPQUFBLENBQUE2RCxFQUFBbkwsSUFDQWEsRUFBQWIsR0FBQTJHLEtBQUEscUJBQUF5RSxJQUdBdkssRUFBQSwyQkFBQUMsTUFBQSxJQUNBQyxFQUFBbkIsaUJBR0EsTUFBQW9CLEVBQUFILEVBQUFFLEVBQUFFLGVBQ0FnSCxFQUFBakgsRUFBQTJGLEtBQUEsYUFDQSxNQUFBMEUsRUFBQUwsaUJBQUEvQyxHQUNBcUQsRUFBQXRLLEVBQUFkLFFBQUEsMkJBR0FtTCxFQUFBN0ssU0FBQSxVQUFBdUcsV0FBQW5HLFlBQUEsVUFDQTBLLEVBQUE5SyxTQUFBLFVBQUF1RyxXQUFBbkcsWUFBQSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgaGFtYnVyZ2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oYW1idXJnZXJcIik7XG5jb25zdCBtZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vcGVuZWRfX21lbnVcIik7XG5jb25zdCBjbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2xvc2UtaWNvblwiKTtcbmNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYm9keVwiKTtcbmNvbnN0IG1lbnVMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51X19saXN0LS1vcGVuZWRcIik7XG5cbmhhbWJ1cmdlci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgbWVudS5jbGFzc0xpc3QuYWRkKFwib3BlbmVkX19tZW51LS1hY3RpdmVcIik7XG4gIGJvZHkuY2xhc3NMaXN0LmFkZChcIm5vc2Nyb2xsXCIpO1xufSk7XG5cbmNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihldmVudCkge1xuICBtZW51LmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuZWRfX21lbnUtLWFjdGl2ZVwiKTtcbiAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKFwibm9zY3JvbGxcIik7XG59KTtcblxubWVudUxpc3QuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIG1lbnUuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5lZF9fbWVudS0tYWN0aXZlXCIpO1xuICBib2R5LmNsYXNzTGlzdC5yZW1vdmUoXCJub3Njcm9sbFwiKTtcbn0pO1xuXG5cbiIsImNvbnN0IG9wZW5JdGVtID0gaXRlbSA9PiB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGl0ZW0uY2xvc2VzdChcIi50ZWFtX19pdGVtXCIpO1xuICBjb25zdCBjb250ZW50QmxvY2sgPSBjb250YWluZXIuZmluZChcIi50ZWFtX19jb250ZW50XCIpO1xuICBjb25zdCB0ZXh0QmxvY2sgPSBjb250ZW50QmxvY2suZmluZChcIi50ZWFtX19jb250ZW50LWJsb2NrXCIpO1xuICBjb25zdCByZXFIZWlnaHQgPSB0ZXh0QmxvY2suaGVpZ2h0KCk7XG5cbiAgY29udGFpbmVyLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICBjb250ZW50QmxvY2suaGVpZ2h0KHJlcUhlaWdodCk7XG59O1xuXG5jb25zdCBjbG9zZUV2ZXJ5SXRlbSA9IGNvbnRhaW5lciA9PiB7XG4gIGNvbnN0IGl0ZW1zID0gY29udGFpbmVyLmZpbmQoXCIudGVhbV9fY29udGVudFwiKTtcbiAgY29uc3QgaXRlbUNvbnRhaW5lciA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2l0ZW1cIik7XG5cbiAgaXRlbUNvbnRhaW5lci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgaXRlbXMuaGVpZ2h0KDApO1xufTtcblxuXG4kKCcudGVhbV9fdGl0bGUnKS5jbGljayAoZSA9PiB7XG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KCcudGVhbScpO1xuICBjb25zdCBlbGVtQ29udGFpbmVyID0gJHRoaXMuY2xvc2VzdChcIi50ZWFtX19pdGVtXCIpO1xuXG4gIGlmIChlbGVtQ29udGFpbmVyLmhhc0NsYXNzKFwiYWN0aXZlXCIpKSB7XG4gICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTtcbiAgfSBlbHNlIHsgXG4gICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTtcbiAgICBvcGVuSXRlbSgkdGhpcyk7XG4gIH1cbn0pOyIsImxldCBteU1hcDtcbmNvbnN0IGluaXQgPSAoKSA9PiB7XG4gbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwXCIsIHtcbiAgIGNlbnRlcjogWzU3LjcwODg3MCwgMTEuOTc0NTYwXSxcbiAgIHpvb206IDExLFxuICAgY29udHJvbHM6IFtdLFxuICAgZ2FyZzogZmFsc2UsXG4gfSk7XG4gXG4gbGV0IGNvb3JkcyA9IFtcbiAgICAgWzU3Ljc4MDkyODk3ODkzMTU1LCAxMS45ODk0OTM1ODYzNDM5OTldLFxuICAgICBbNTcuNzI3NDc5OTEyMzQ4NzgsIDExLjk1NzgzNDIzMTQ4OTU0XSxcbiAgICAgWzU3LjY4MzgwNDg2OTQ0OTM4LCAxMS45MzY1NzA0ODU2OTE3NjddLFxuICAgICBbNTcuNjYzODQzMjUxNzMyNzg2LCAxMi4wMzE1NDg1NTAyNTUxNDVdLCAgICAgXG4gICBdLFxuICAgbXlDb2xsZWN0aW9uID0gbmV3IHltYXBzLkdlb09iamVjdENvbGxlY3Rpb24oe30sIHtcbiAgICAgZHJhZ2dhYmxlOiBmYWxzZSxcbiAgICAgaWNvbkxheW91dDogJ2RlZmF1bHQjaW1hZ2UnLFxuICAgICBpY29uSW1hZ2VIcmVmOiAnL3NyYy9pbWFnZXMvbWFya2VyLnN2ZycsXG4gICAgIGljb25JbWFnZVNpemU6IFs0NiwgNTddLFxuICAgICBpY29uSW1hZ2VPZmZzZXQ6IFstMzUsIC01Ml1cbiAgIH0pO1xuIFxuIGZvciAobGV0IGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aDsgaSsrKSB7XG4gICBteUNvbGxlY3Rpb24uYWRkKG5ldyB5bWFwcy5QbGFjZW1hcmsoY29vcmRzW2ldKSk7XG4gfVxuIFxuIG15TWFwLmdlb09iamVjdHMuYWRkKG15Q29sbGVjdGlvbik7XG4gXG4gbXlNYXAuYmVoYXZpb3JzLmRpc2FibGUoJ3Njcm9sbFpvb20nKTtcbn07XG4gXG55bWFwcy5yZWFkeShpbml0KTsiLCJjb25zdCBtZXN1cmVXaWR0aCA9IGl0ZW0gPT4ge1xuICBsZXQgcmVxSXRlbVdpZHRoID0gMDtcbiAgY29uc3Qgc2NyZWVuV2lkdGggPSAkKHdpbmRvdykud2lkdGgoKTtcbiAgY29uc3QgY29udGFpbmVyID0gaXRlbS5jbG9zZXN0KFwiLnByb2R1Y3RzLW1lbnVcIik7XG4gIGNvbnN0IHRpdGxlc0Jsb2NrcyA9IGNvbnRhaW5lci5maW5kKFwiLnByb2R1Y3RzLW1lbnVfX3RpdGxlXCIpO1xuICBjb25zdCB0aXRsZXNXaWR0aCA9IHRpdGxlc0Jsb2Nrcy53aWR0aCgpICogdGl0bGVzQmxvY2tzLmxlbmd0aDtcblxuICBjb25zdCB0ZXh0Q29udGFpbmVyID0gaXRlbS5maW5kKFwiLnByb2R1Y3RzLW1lbnVfX2NvbnRhaW5lclwiKTtcbiAgY29uc3QgcGFkZGluZ0xlZnQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctbGVmdFwiKSk7XG4gIGNvbnN0IHBhZGRpbmdSaWdodCA9IHBhcnNlSW50KHRleHRDb250YWluZXIuY3NzKFwicGFkZGluZy1yaWdodFwiKSk7XG5cbiAgY29uc3QgaXNNb2JpbGUgPSB3aW5kb3cubWF0Y2hNZWRpYShcIihtYXgtd2lkdGg6IDc2OHB4KVwiKS5tYXRjaGVzO1xuXG4gIGlmIChpc01vYmlsZSkge1xuICAgIHJlcUl0ZW1XaWR0aCA9IHNjcmVlbldpZHRoIC0gdGl0bGVzV2lkdGg7XG4gIH0gZWxzZSB7XG4gICAgcmVxSXRlbVdpZHRoID0gNTAwOyAgXG4gIH1cblxuICByZXR1cm4ge1xuICAgIGNvbnRhaW5lcjogcmVxSXRlbVdpZHRoLFxuICAgIHRleHRDb250YWluZXI6IHJlcUl0ZW1XaWR0aCAtIHBhZGRpbmdSaWdodCAtIHBhZGRpbmdMZWZ0XG4gIH1cbn07XG5cbmNvbnN0IGNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIgPSAoY29udGFpbmVyKSA9PiB7XG4gIGNvbnN0IGl0ZW1zID0gY29udGFpbmVyLmZpbmQoXCIucHJvZHVjdHMtbWVudV9faXRlbVwiKTtcbiAgY29uc3QgY29udGVudCA9IGNvbnRhaW5lci5maW5kIChcIi5wcm9kdWN0cy1tZW51X19jb250ZW50XCIpO1xuXG4gIGl0ZW1zLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICBjb250ZW50LndpZHRoKDApO1xufTtcblxuY29uc3Qgb3BlbmluZ0l0ZW0gPSBpdGVtID0+IHtcbiAgY29uc3QgaGlkZGVuQ29udGVudCA9IGl0ZW0uZmluZChcIi5wcm9kdWN0cy1tZW51X19jb250ZW50XCIpO1xuICBjb25zdCByZXFXaWR0aCA9IG1lc3VyZVdpZHRoKGl0ZW0pO1xuICBjb25zdCB0ZXh0QmxvY2sgPSBpdGVtLmZpbmQoXCIucHJvZHVjdHMtbWVudV9fY29udGFpbmVyXCIpO1xuXG4gIGl0ZW0uYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4gIGhpZGRlbkNvbnRlbnQud2lkdGgocmVxV2lkdGguY29udGFpbmVyKTtcbiAgdGV4dEJsb2NrLndpZHRoKHJlcVdpZHRoLnRleHRDb250YWluZXIpO1xufTtcblxuJChcIi5wcm9kdWN0cy1tZW51X190aXRsZVwiKS5vbihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgY29uc3QgaXRlbSA9ICR0aGlzLmNsb3Nlc3QoXCIucHJvZHVjdHMtbWVudV9faXRlbVwiKTtcbiAgY29uc3QgaXRlbU9wZW5lZCA9IGl0ZW0uaGFzQ2xhc3MoXCJhY3RpdmVcIik7XG4gIGNvbnN0IGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIucHJvZHVjdHMtbWVudVwiKTtcblxuICBpZiAoaXRlbU9wZW5lZCkge1xuICAgIGNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIoY29udGFpbmVyKVxuICB9IGVsc2Uge1xuICAgIGNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIoY29udGFpbmVyKVxuICAgIG9wZW5pbmdJdGVtKGl0ZW0pO1xuICB9XG59KTtcblxuJChcIi5wcm9kdWN0cy1tZW51X19jbG9zZVwiKS5vbihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICBjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyKCQoXCIucHJvZHVjdHMtbWVudVwiKSk7XG59KTsiLCJjb25zdCB2YWxpZGF0ZUZpZWxkcyA9IChmb3JtLCBmaWVsZHNBcnJheSkgPT4ge1xuICBcbiAgZmllbGRzQXJyYXkuZm9yRWFjaCgoZmllbGQpID0+IHtcbiAgICBmaWVsZC5yZW1vdmVDbGFzcyhcImlucHV0LWVycm9yXCIpO1xuICAgIGlmKGZpZWxkLnZhbCgpLnRyaW0oKT09IFwiXCIpIHtcbiAgICAgIGZpZWxkLmFkZENsYXNzKFwiaW5wdXQtZXJyb3JcIik7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBlcnJvckZpZWxkcyA9IGZvcm0uZmluZCgnLmlucHV0LWVycm9yJyk7XG5cbiAgcmV0dXJuIGVycm9yRmllbGRzLmxlbmd0aCA9PSAwO1xufVxuJCgnLmZvcm0nKS5zdWJtaXQoKGUpPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3QgZm9ybSA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgY29uc3QgbmFtZSA9IGZvcm0uZmluZChcIltuYW1lPSduYW1lJ11cIik7XG4gIGNvbnN0IHBob25lID0gZm9ybS5maW5kKFwiW25hbWU9J3Bob25lJ11cIik7XG4gIGNvbnN0IGNvbW1lbnQgPSBmb3JtLmZpbmQoXCJbbmFtZT0nY29tbWVudCddXCIpO1xuICBjb25zdCB0byA9IGZvcm0uZmluZChcIltuYW1lPSd0byddXCIpO1xuXG4gIGNvbnN0IG1vZGFsID0gJChcIiNtb2RhbFwiKTtcbiAgY29uc3QgY29udGVudCA9IG1vZGFsLmZpbmQoXCJtb2RhbF9fY29udGVudFwiKVxuXG4gIGNvbnN0IGlzVmFsaWQgPSB2YWxpZGF0ZUZpZWxkcyhmb3JtLCBbbmFtZSwgcGhvbmUsIGNvbW1lbnQsIHRvXSk7XG5cbiAgbW9kYWwucmVtb3ZlQ2xhc3MoXCJlcnJvci1tb2RhbFwiKTtcbiAgXG4gIGlmKGlzVmFsaWQpIHtcbiAgIGNvbnN0IHJlcXVlc3QgPSAkLmFqYXgoe1xuICAgICAgdXJsOiBcImh0dHBzOi8vd2ViZGV2LWFwaS5sb2Z0c2Nob29sLmNvbS9zZW5kbWFpbFwiLFxuICAgICAgbWV0aG9kOiBcInBvc3RcIixcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgbmFtZTogbmFtZS52YWwoKSxcbiAgICAgICAgcGhvbmU6IHBob25lLnZhbCgpLFxuICAgICAgICBjb21tZW50OiBjb21tZW50LnZhbCgpLFxuICAgICAgICB0bzogdG8udmFsKClcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICByZXF1ZXN0LmRvbmUoKGRhdGEpID0+IHtcbiAgICAgIGNvbnRlbnQudGV4dChkYXRhLm1lc3NhZ2UpO1xuICAgICAgfSk7XG5cbiAgICByZXF1ZXN0LmZhaWwoKGRhdGEpID0+IHsgICBcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBkYXRhLnJlc3BvbnNlSlNPTi5tZXNzYWdlO1xuICAgICAgY29udGVudC50ZXh0KG1lc3NhZ2UpO1xuICAgICAgbW9kYWwuYWRkQ2xhc3MoXCJlcnJvci1tb2RhbFwiKTtcbiAgICB9KTtcblxuICAgIHJlcXVlc3QuYWx3YXlzKCgpID0+IHtcbiAgICAgICQuZmFuY3lib3gub3Blbih7XG4gICAgICAgIHNyYzogXCIjbW9kYWxcIixcbiAgICAgICAgdHlwZTogXCJpbmxpbmVcIixcbiAgICAgICAgICBcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgfVxufSk7XG5cbiQoJy5idXR0b24tY2xvc2UnKS5jbGljayhlID0+IHsgXG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBmb3JtID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuXG4gICQuZmFuY3lib3guY2xvc2UoKTtcbiAgXG4gICQoJyNmb3JtJylbMF0ucmVzZXQoKTtcbn0pO1xuXG4iLCJcbmNvbnN0IHNlY3Rpb25zID0gJChcIi5zZWN0aW9uXCIpO1xuY29uc3QgZGlzcGxheSA9ICQoXCIubWFpbmNvbnRlbnRcIik7XG5jb25zdCBzaWRlTWVudSA9ICQoXCIuZml4ZWQtbWVudVwiKTtcbmNvbnN0IG1lbnVJdGVtcyA9IHNpZGVNZW51LmZpbmQoXCIuZml4ZWQtbWVudV9faXRlbVwiKTtcblxubGV0IGluU2Nyb2xsID0gZmFsc2U7XG5cblxuc2VjdGlvbnMuZmlyc3QoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcblxuY29uc3QgY291bnRTZWN0aW9uUG9zaXRpb24gPSBzZWN0aW9uRXEgPT4ge1xuICByZXR1cm4gc2VjdGlvbkVxICogLTEwMDtcbn07XG5cbmNvbnN0IGNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24gPSAoc2VjdGlvbkVxKSA9PiB7XG5jb25zdCBjdXJyZW50U2VjdGlvbiA9IHNlY3Rpb25zLmVxKHNlY3Rpb25FcSk7XG5jb25zdCBtZW51VGhlbWUgPSBjdXJyZW50U2VjdGlvbi5hdHRyKFwiZGF0YS1zaWRlbWVudS10aGVtZVwiKTtcbmNvbnN0IGFjdGl2ZUNsYXNzID0gXCJmaXhlZC1tZW51LS1zaGFkb3dlZFwiOyAgXG5cbiAgaWYgKG1lbnVUaGVtZSA9PSBcImJsYWNrXCIpIHtcbiAgICBzaWRlTWVudS5hZGRDbGFzcyhcImFjdGl2ZUNsYXNzXCIpO1xuICB9IGVsc2Uge1xuICAgIHNpZGVNZW51LnJlbW92ZUNsYXNzKFwiY3RpdmVDbGFzc1wiKTtcbiAgfVxuICAgfTtcblxuXG4gICBjb25zdCByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbSA9IChpdGVtcywgaXRlbUVxLCBhY3RpdmVDbGFzcykgPT4ge1xuICAgICBpdGVtcy5lcShpdGVtRXEpLmFkZENsYXNzKGFjdGl2ZUNsYXNzKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcbiAgICB9O1xuXG5jb25zdCBwZXJmb3JtVHJhbnNpdGlvbiA9IChzZWN0aW9uRXEpID0+IHtcbiBjb25zdCBwb3NpdGlvbiA9IChzZWN0aW9uRXEpICogKC0xMDApO1xuICBpZihpblNjcm9sbCA9PSBmYWxzZSkge1xuICAgIGluU2Nyb2xsID0gdHJ1ZTtcblxuICAgIGNvbnN0IHBvc2l0aW9uID1jb3VudFNlY3Rpb25Qb3NpdGlvbihzZWN0aW9uRXEpO1xuICAgIGNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24oc2VjdGlvbkVxKTtcbiAgICBcbiAgICAgIFxuICAgIFxuICAgICAgIFxuXG4gICAgZGlzcGxheS5jc3Moe1xuICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSUpYCxcbiAgICB9KTtcblxuIHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtKHNlY3Rpb25zLCBzZWN0aW9uRXEsIFwiYWN0aXZlXCIpO1xuICAgICAgICAvLyAgfSwgdHJhbnNpdGlvbk92ZXIgKyBtb3VzZUluZXJ0aWFPdmVyKTtcblxuICAgIHNlY3Rpb25zLmVxKHNlY3Rpb25FcSkuYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiBcbiAgICBcblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGluU2Nyb2xsID0gZmFsc2U7XG5cbiAgICAgICAgICByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbShtZW51SXRlbXMsIHNlY3Rpb25FcSwgXCIuZml4ZWQtbWVudV9faXRlbS0tYWN0aXZlXCIpO1xuXG4gICAgICAgICAgc2lkZU1lbnUuZmluZChcIi5maXhlZC1tZW51X19pdGVtXCIpLmVxKHNlY3Rpb25FcSkuYWRkQ2xhc3MoXCJmaXhlZC1tZW51X19pdGVtLS1hY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImZpeGVkLW1lbnVfX2l0ZW0tLWFjdGl2ZVwiKTtcbiAgICAgICBcbiAgfSwgMTMwMCk7XG59XG4gICAgLy8gaWYoaW5TY3JvbGwpIHJldHVybjtcbiAgICAgIFxuICAgIC8vIGNvbnN0IHRyYW5zaXRpb25PdmVyID0gMTAwMDtcbiAgICAvLyBjb25zdCBtb3VzZUluZXJ0aWFPdmVyID0gMzAwO1xuICBcbiAgICAvLyAgIGluU2Nyb2xsID0gdHJ1ZTtcbiAgICAgIFxuICAgICBcbiAgXG4gICAgICAvLyBjaGFuZ2VNZW51VGhlbWVGb3JTZWN0aW9uKHNlY3Rpb25FcSk7XG4gIFxuICAgICAgXG4gICAgfTtcblxuICAgIGNvbnN0IHNjcm9sbFZpZXdwb3J0ID0gKGRpcmVjdGlvbikgPT4ge1xuICAgICAgY29uc3QgYWN0aXZlU2VjdGlvbiA9IHNlY3Rpb25zLmZpbHRlcihcIi5hY3RpdmVcIik7IFxuICAgICAgY29uc3QgbmV4dFNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLm5leHQoKTtcbiAgICAgIGNvbnN0IHByZXZTZWN0aW9uID0gYWN0aXZlU2VjdGlvbi5wcmV2KCk7XG4gICAgXG4gICAgICBpZiAoZGlyZWN0aW9uID09IFwibmV4dFwiICYmIG5leHRTZWN0aW9uLmxlbmd0aCkge1xuICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihuZXh0U2VjdGlvbi5pbmRleCgpKTtcbiAgICAgICAgXG4gICAgICB9XG4gICAgXG4gICAgICBpZiAoZGlyZWN0aW9uID09IFwicHJldlwiICYmIHByZXZTZWN0aW9uLmxlbmd0aCkge1xuICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKTtcbiAgICAgICBcbiAgICAgIH1cbiAgICB9O1xuXG5cbiQod2luZG93KS5vbihcIndoZWVsXCIsIGUgPT4ge1xuICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xuXG5cbiAgaWYgKGRlbHRhWSA+IDApIHtcbiAgICBzY3JvbGxWaWV3cG9ydChcIm5leHRcIik7XG4gICAgLy9uZXh0XG4gIH1cblxuICBpZiAoZGVsdGFZIDwgMCkge1xuICAgIHNjcm9sbFZpZXdwb3J0KFwicHJldlwiKTtcbiAgICAvL3ByZXZcbiAgfVxufSk7XG5cbiQod2luZG93KS5vbihcImtleWRvd25cIiwgKGUpID0+IHtcblxuICAgIGNvbnN0IHRhZ05hbWUgPSBlLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgIGlmICh0YWdOYW1lICE9PSBcImlucHV0XCIgJiYgdGFnTmFtZSAhPT0gXCJ0ZXh0YXJlYVwiKSB7XG4gICAgXG4gICAgc3dpdGNoIChlLmtleUNvZGUpIHtcbiAgICAgIGNhc2UgMzg6XG4gICAgICAgIHNjcm9sbFZpZXdwb3J0KFwicHJldlwiKTtcbiAgICAgICAgYnJlYWs7XG4gICAgXG4gICAgICAgIGNhc2UgNDA6XG4gICAgICAgIHNjcm9sbFZpZXdwb3J0KFwibmV4dFwiKTtcbiAgICAgICAgYnJlYWs7XG59XG4gICB9XG59KTtcblxuJChcIltkYXRhLXNjcm9sbC10b11cIikuY2xpY2soZSA9PntcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBcbiAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XG4gIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLXNjcm9sbC10b1wiKTtcbiAgY29uc3QgcmVxU2VjdGlvbiA9ICQoYFtkYXRhLXNlY3Rpb24taWQ9JHt0YXJnZXR9XWApO1xuICBcbiAgcGVyZm9ybVRyYW5zaXRpb24ocmVxU2VjdGlvbi5pbmRleCgpKTtcbiAgIFxufSk7XG4gXG4gICAgXG5cbiAgXG5cbi8vIGxldCBpblNjcm9sbCA9IGZhbHNlO1xuXG4vLyBcblxuLy8gXG5cbi8vXG5cbi8vIGNvbnN0IHBlcmZvcm1UcmFuc2l0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xuLy8gICBpZihpblNjcm9sbCkgcmV0dXJuO1xuICAgIFxuLy8gICBjb25zdCB0cmFuc2l0aW9uT3ZlciA9IDEwMDA7XG4vLyAgIGNvbnN0IG1vdXNlSW5lcnRpYU92ZXIgPSAzMDA7XG5cbi8vICAgICBpblNjcm9sbCA9IHRydWU7XG4gICAgXG4vLyAgICAgY29uc3QgcG9zaXRpb24gPSBjb3VudFNlY3Rpb25Qb3NpdGlvbihzZWN0aW9uRXEpO1xuXG4vLyAgICAgY2hhbmdlTWVudVRoZW1lRm9yU2VjdGlvbihzZWN0aW9uRXEpO1xuXG4vLyAgICAgZGlzcGxheS5jc3Moe1xuLy8gICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSUpYCxcbi8vICAgICB9KTtcblxuLy8gICAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0oc2VjdGlvbnMsIHNlY3Rpb25FcSwgXCJhY3RpdmVcIik7XG5cbi8vICAgIC8qc2VjdGlvbnMuZXEoc2VjdGlvbkVxKS5hZGRDbGFzcyhcImFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpOyovXG5cbi8vICAgIHNpZGVNZW51LmZpbmQoXCIuZml4ZWQtbWVudV9faXRlbVwiKS5lcShzZWN0aW9uRXEpLmFkZENsYXNzKFwiZml4ZWQtbWVudV9faXRlbS0tYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJmaXhlZC1tZW51X19pdGVtLS1hY3RpdmVcIik7XG5cbi8vICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuLy8gICAgIGluU2Nyb2xsID0gZmFsc2U7XG4vLyAgICAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0obWVudUl0ZW1zLCBzZWN0aW9uRXEsIFwiZml4ZWQtbWVudV9faXRlbS0tYWN0aXZlXCIpO1xuLy8gICAgfSwgdHJhbnNpdGlvbk92ZXIgKyBtb3VzZUluZXJ0aWFPdmVyKTtcbiBcbi8vIH07XG5cblxuXG4vLyAkKHdpbmRvdykub24oXCJ3aGVlbFwiLCAoZSkgPT4ge1xuLy8gICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xuXG4vLyAgIGlmIChkZWx0YVkgPiAwKSB7XG4gICAgXG4vLyAgICAgc2Nyb2xsVmlld3BvcnQoXCJuZXh0XCIpO1xuLy8gICB9XG5cbi8vICAgaWYgKGRlbHRhWSA8IDApIHtcblxuLy8gICAgIHNjcm9sbFZpZXdwb3J0KFwicHJldlwiKTtcbi8vICAgfVxuLy8gfSk7XG5cbi8vICQod2luZG93KS5vbihcImtleWRvd25cIiwgKGUpID0+IHtcblxuLy8gICBjb25zdCB0YWdOYW1lID0gZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuLy8gICBjb25zdCB1c2VyVHlwaW5nSW5wdXRzID0gdGFnTmFtZSA9PSBcImlucHV0XCIgfHwgdGFnTmFtZSA9PSBcInRleHRhcmVhXCI7XG5cbi8vICAgaWYgKHVzZXJUeXBpbmdJbnB1dHMpIHJldHVybjsgXG4vLyAgICAgc3dpdGNoIChlLmtleUNvZGUpIHtcbi8vICAgICAgIGNhc2UgMzg6XG4vLyAgICAgICAgIHNjcm9sbFZpZXdwb3J0KFwicHJldlwiKTtcbi8vICAgICAgICAgYnJlYWs7XG4gICAgXG4vLyAgICAgICAgIGNhc2UgNDA6XG4vLyAgICAgICAgIHNjcm9sbFZpZXdwb3J0KFwibmV4dFwiKTtcbi8vICAgICAgICAgYnJlYWs7XG4vLyAgICB9XG4vLyB9KTtcblxuLy8gJChcIltkYXRhLXNjcm9sbC10b11cIikuY2xpY2soZSA9Pntcbi8vICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4vLyAgIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuLy8gICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1zY3JvbGwtdG9cIik7XG4vLyAgIGNvbnN0IHJlcVNlY3Rpb24gPSAkKGBbZGF0YS1zZWN0aW9uLWlkPSR7dGFyZ2V0fV1gKTtcblxuLy8gICBwZXJmb3JtVHJhbnNpdGlvbihyZXFTZWN0aW9uLmluZGV4KCkpO1xuXG5cbi8vIH0pOyIsImxldCBwbGF5ZXI7XG5jb25zdCBwbGF5ZXJDb250YWluZXIgPSAkKCcucGxheWVyJyk7XG5jb25zdCBwbGF5ZXJTdGFydCA9ICQoJy5wbGF5ZXJfX3N0YXJ0Jyk7XG5jb25zdCB2b2x1bWVCdG4gPSAkKFwiLnZvbHVtZV9fcGljXCIpO1xuXG5cbmxldCBldmVudHNJbml0ID0gKCkgPT4ge1xuICAgICQoXCIucGxheWVyX19zdGFydFwiKS5jbGljayhlID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGNvbnN0IGJ0biA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcblxuICAgICAgICBpZiAocGxheWVyU3RhcnQuaGFzQ2xhc3MoXCJwbGF5ZXItLXBhdXNlZFwiKSl7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcGxheWVyLnBhdXNlVmlkZW8oKTtcblxuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcGxheWVyLnBsYXlWaWRlbygpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBvblBsYXllclJlYWR5KCk7XG4gICAgfSk7XG5cbiAgICAkKFwiLnBsYXllcl9fcGxheWJhY2tcIikuY2xpY2soZSA9PiB7XG4gICAgICAgIGNvbnN0IGJhciA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgY29uc3QgY2xpY2tlZFBvc2l0aW9uID0gZS5vcmlnaW5hbEV2ZW50LmxheWVyWDtcbiAgICAgICAgY29uc3QgbmV3QnV0dG9uUG9zaXRpb25QZXJjZW50ID0gKGNsaWNrZWRQb3NpdGlvbiAvIGJhci53aWR0aCgpKSAqIDEwMDtcbiAgICAgICAgY29uc3QgbmV3UGxheWJhY2tQb3NpdGlvblNlYyA9IFxuICAgICAgICAgICAgKHBsYXllci5nZXREdXJhdGlvbigpIC8gMTAwKSAqIG5ld0J1dHRvblBvc2l0aW9uUGVyY2VudDtcblxuXG4gICAgICAgICQoXCIucGxheWVyX19wbGF5YmFjay1idXR0b25cIikuY3NzKHtcbiAgICAgICAgICAgIGxlZnQ6IGAke25ld0J1dHRvblBvc2l0aW9uUGVyY2VudH0lYFxuICAgICAgICB9KTtcblxuICAgICAgICBwbGF5ZXIuc2Vla1RvKG5ld1BsYXliYWNrUG9zaXRpb25TZWMpO1xuICAgIH0pO1xuXG4gICAgJChcIi5wbGF5ZXJfX3NwbGFzaF9fcGxheVwiKS5jbGljayhlID0+IHtcbiAgICAgICAgcGxheWVyLnBsYXlWaWRlbygpO1xuICAgIH0pO1xuXG5cbiAgICAkKFwiLnZvbHVtZV9fcGljXCIpLmNsaWNrKGUgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgaWYgKHZvbHVtZUJ0bi5oYXNDbGFzcyhcInZvbHVtZV9fcGljLS1ub3NvdW5kXCIpKXtcblxuICAgICAgICAgICAgcGxheWVyLnVuTXV0ZSgpO1xuICAgICAgICAgICAgdm9sdW1lQnRuLnJlbW92ZUNsYXNzKFwidm9sdW1lX19waWMtLW5vc291bmRcIik7XG5cbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHBsYXllci5tdXRlKCk7XG4gICAgICAgICAgICB2b2x1bWVCdG4uYWRkQ2xhc3MoXCJ2b2x1bWVfX3BpYy0tbm9zb3VuZFwiKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgJChcIi52b2x1bWVfX3BsYXliYWNrXCIpLmNsaWNrKGUgPT4ge1xuXG4gICAgICAgIGNvbnN0IGJhclZvbHVtZSA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgY29uc3QgY2xpY2tlZFBvc2l0aW9uVm9sdW1lID0gZS5vcmlnaW5hbEV2ZW50LmxheWVyWDtcbiAgICAgICAgY29uc3QgbmV3Vm9sdW1lQnV0dG9uUG9zaXRpb25QZXJjZW50ID0gKGNsaWNrZWRQb3NpdGlvblZvbHVtZSAvIGJhclZvbHVtZS53aWR0aCgpKSAqIDEwMDtcbiAgICAgICAgbGV0IHZvbHVtZVBvaW50ID0gcGxheWVyLmdldFZvbHVtZSgpO1xuICAgIFxuICAgIFxuICAgICAgICAkKFwiLnZvbHVtZV9fcGxheWJhY2stYnV0dG9uXCIpLmNzcyh7XG4gICAgICAgICAgICBsZWZ0OiBgJHtuZXdWb2x1bWVCdXR0b25Qb3NpdGlvblBlcmNlbnR9JWBcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcGxheWVyLnNldFZvbHVtZShuZXdWb2x1bWVCdXR0b25Qb3NpdGlvblBlcmNlbnQpO1xuICAgICAgICBcbiAgICB9KTtcblxuICAgIFxufTtcblxuXG5jb25zdCBvblBsYXllclJlYWR5ID0gKCkgPT4ge1xuICAgIGxldCBpbnRlcnZhbDtcbiAgICBjb25zdCBkdXJhdGlvblNlYyA9IHBsYXllci5nZXREdXJhdGlvbigpO1xuXG4gICAgaWYgKHR5cGVvZiBpbnRlcnZhbCAhPT0gXCJ1bmRlZmluZWRcIil7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgIH1cblxuICAgIGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBjb25zdCBjb21wbGV0ZWRTZWMgPSBwbGF5ZXIuZ2V0Q3VycmVudFRpbWUoKTtcbiAgICAgICAgY29uc3QgY29tcGxldGVkUGVyY2VudCA9IChjb21wbGV0ZWRTZWMgLyBkdXJhdGlvblNlYykgKiAxMDA7XG5cbiAgICAgICAgJChcIi5wbGF5ZXJfX3BsYXliYWNrLWJ1dHRvblwiKS5jc3Moe1xuICAgICAgICAgICAgbGVmdDogYCR7Y29tcGxldGVkUGVyY2VudH0lYFxuICAgICAgICB9KTtcblxuICAgIH0sIDEwMDApO1xufTtcblxuXG5jb25zdCBvblBsYXllclN0YXRlQ2hhbmdlID0gZXZlbnQgPT4ge1xuICAgIHN3aXRjaChldmVudC5kYXRhKXtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcGxheWVyQ29udGFpbmVyLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgcGxheWVyU3RhcnQuYWRkQ2xhc3MoXCJwbGF5ZXItLXBhdXNlZFwiKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBwbGF5ZXJDb250YWluZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICBwbGF5ZXJTdGFydC5yZW1vdmVDbGFzcyhcInBsYXllci0tcGF1c2VkXCIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBvbllvdVR1YmVJZnJhbWVBUElSZWFkeSgpIHtcbiAgICBwbGF5ZXIgPSBuZXcgWVQuUGxheWVyKCd5dC1wbGF5ZXInLCB7XG4gICAgICAgIGhlaWdodDogJzQwNScsXG4gICAgICAgIHdpZHRoOiAnNjYwJyxcbiAgICAgICAgdmlkZW9JZDogJ0xYYjNFS1dzSW5RJyxcbiAgICAgICAgZXZlbnRzOntcbiAgICAgICAgICAgICdvblJlYWR5Jzogb25QbGF5ZXJSZWFkeSxcbiAgICAgICAgICAgICdvblN0YXRlQ2hhbmdlJzogb25QbGF5ZXJTdGF0ZUNoYW5nZVxuICAgICAgICB9LFxuICAgICAgICBwbGF5ZXJWYXJzOiB7XG4gICAgICAgICAgICBjb250cm9sczogMCxcbiAgICAgICAgICAgIGRpc2FibGVrYjogMCxcbiAgICAgICAgICAgIHNob3dpbmZvOiAwLFxuICAgICAgICAgICAgcmVsOiAwLFxuICAgICAgICAgICAgYXV0b3BsYXk6IDAsXG4gICAgICAgICAgICBtb2Rlc2JyYW5kaW5nOiAwXG4gICAgICAgIH1cbiAgICB9KVxufTtcblxuXG5ldmVudHNJbml0KCk7IiwiY29uc3Qgc2xpZGVyID0gJChcIi5zbGlkZXJcIikuYnhTbGlkZXIoe1xuICBwYWdlcjogZmFsc2UsXG4gIGNvbnRyb2xzOiBmYWxzZVxufSk7XG5cbiQoXCIuYXJyb3ctbGVmdFwiKS5jbGljaygoZSkgPT4ge1xuXG4gIHNsaWRlci5nb1RvUHJldlNsaWRlKCk7XG5cbn0pO1xuXG4kKFwiLmFycm93LXJpZ2h0XCIpLmNsaWNrKChlKSA9PiB7XG5cbiAgc2xpZGVyLmdvVG9OZXh0U2xpZGUoKTtcblxufSk7IiwiY29uc3QgZmluZEJsb2NrQnlBbGlhcyA9IChhbGlhcykgPT4ge1xuICByZXR1cm4gJChcIi5yZXZpZXdzLWl0ZW1cIikuZmlsdGVyKChuZHgsIGl0ZW0pID0+IHtcbiAgICByZXR1cm4gJChpdGVtKS5hdHRyKFwiZGF0YS1saW5rZWQtd2l0aFwiKSA9PSBhbGlhcztcbiAgfSk7XG59O1xuJChcIi5yZXZpZXdzLXN3aXRjaGVyX19saW5rXCIpLmNsaWNrKChlKSA9PiB7IFxuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cblxuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgY29uc3QgdGFyZ2V0ID0gJHRoaXMuYXR0cihcImRhdGEtb3BlblwiKTtcbiAgY29uc3QgaXRlbVRvU2hvdyA9IGZpbmRCbG9ja0J5QWxpYXModGFyZ2V0KTtcbiAgY29uc3QgY3VySXRlbSA9ICR0aGlzLmNsb3Nlc3QoXCIucmV2aWV3cy1zd2l0Y2hlcl9faXRlbVwiKTtcblxuXG4gIGl0ZW1Ub1Nob3cuYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgY3VySXRlbS5hZGRDbGFzcyhcImFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xufSk7Il19
